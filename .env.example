# ============================================
# Loop Gateway - Environment Configuration
# ============================================
# Copy this file to .env and adjust values

# --- Required ---
ANTHROPIC_API_KEY=sk-ant-xxxxx

# --- Server ---
PORT=3000
HOST=0.0.0.0

# --- Agent ---
# Model to use: claude-sonnet-4-20250514, claude-opus-4-20250514, claude-haiku-4-5-20251001
AGENT_MODEL=claude-sonnet-4-20250514
# Max tokens per agent response
AGENT_MAX_TOKENS=8192
# System prompt file path (inside container)
AGENT_SYSTEM_PROMPT_FILE=/data/system-prompt.md

# --- Retry & Circuit Breaker ---
# Retries on transient API errors (429, 500, 502, 503, 529) with exponential backoff
RETRY_MAX_RETRIES=3
RETRY_BASE_DELAY_MS=1000
RETRY_MAX_DELAY_MS=30000
RETRY_JITTER_FACTOR=0.2
# Circuit breaker opens after N consecutive failures, blocking calls for a cooldown period
CB_FAILURE_THRESHOLD=5
CB_RESET_TIMEOUT_MS=60000
CB_HALF_OPEN_SUCCESS_THRESHOLD=1

# --- Container Isolation (optional) ---
# Run each agent invocation in an isolated Docker container (nanoclaw pattern)
# Requires: docker build -t loop-gateway-agent:latest ./agent-runner
AGENT_CONTAINER_MODE=false
# Max concurrent containers (default 3)
MAX_CONCURRENT_CONTAINERS=3
# Container timeout in ms (default 600000 = 10 min)
CONTAINER_TIMEOUT_MS=600000

# --- Telegram (optional) ---
# Get a bot token from @BotFather on Telegram
TELEGRAM_BOT_TOKEN=
# Comma-separated list of allowed Telegram user IDs (leave empty to allow all)
TELEGRAM_ALLOWED_USERS=

# --- WhatsApp (optional) ---
# WhatsApp will show a QR code in the Web UI on first connect
WHATSAPP_ENABLED=false

# --- Email (optional) ---
EMAIL_IMAP_HOST=
EMAIL_IMAP_PORT=993
EMAIL_IMAP_USER=
EMAIL_IMAP_PASS=
EMAIL_SMTP_HOST=
EMAIL_SMTP_PORT=587
EMAIL_SMTP_USER=
EMAIL_SMTP_PASS=
EMAIL_POLL_INTERVAL_MS=30000
# Only process emails from these addresses (comma-separated, leave empty for all)
EMAIL_ALLOWED_SENDERS=

# --- CapCut API (optional) ---
# Local CapCutAPI server (https://github.com/sun-guannan/CapCutAPI)
# Requires: python capcut_server.py running, CapCut installed, FFmpeg
CAPCUT_API_HOST=http://localhost
CAPCUT_API_PORT=9001
